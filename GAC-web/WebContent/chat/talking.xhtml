<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:a4j="http://richfaces.org/a4j">
    <h:body>
    	<ui:composition template="/templates/layout.xhtml">
   	 		<ui:define name="title">
				Conversation
			</ui:define> 
    		<ui:define name="content">
    			<div class="container">
	    			<!-- YOUR CODE STARTS HERE -->
	    			<div class="alert alert-error">
    					<button type="button" class="close" data-dismiss="alert">x</button>
    					<h:messages id="messages" globalOnly="true" layout="table" styleClass="errorMessage" />
					</div>
	    			<f:event type="preRenderView" listener="#{talking.init}" />
	    			
	    			<div class="well">
	    				<a4j:repeat var="mes" value="#{talking.listMessages}" ajaxKeys="#{talking.updatedRow}">						
							<p>
								<span class="label label-info">#{talking.getFullName(mes)}</span> 
								<small><em>
									<h:outputText value="#{mes.sendTime}">
  										<f:convertDateTime type="date" pattern="dd-MM-yyyy HH:mm"/>
									</h:outputText>
								</em></small><br />
								#{mes.content}
							</p>											 
				   		</a4j:repeat>
			   		</div>
			   		<h:form id="messageForm">
				   		<div class="span12">
				   			<h:inputTextarea id="textMessage" value="#{talking.textMessage}" class="span11" placeholder="RÃ©pondre..." required="true" />
				   		</div>
				   		<h:inputHidden value="#{talking.idConv}" id="idConv" />
				   		<div class="span2 offset5">
				   			<a4j:commandButton value="Envoyer" action="#{talking.sendMessage}" styleClass="btn btn-large btn-primary"></a4j:commandButton>
				   		</div>
				   		<a4j:commandButton value="test" action="#{talking.testAdd}"></a4j:commandButton>
			   		</h:form>
	    			<!-- AND ENDS HERE  -->
        		</div>
    		</ui:define>
    	</ui:composition>
    </h:body>
</html>